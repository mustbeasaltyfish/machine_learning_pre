:root {
    /* Colors */
    --color-surface: #ffffff;
    --color-surface-container: #f0f4f8;
    --color-on-surface: #1f1f1f;
    --color-on-surface-variant: #444746;
    --color-primary: #1a73e8;
    --gemini-gradient: linear-gradient(135deg, #4285f4, #9b72cb, #ea4335, #fbbc04);
    
    --font-family: "Google Sans", "Roboto", sans-serif;
    --font-mono: "Roboto Mono", "SFMono-Regular", Consolas, "Liberation Mono", monospace;
    
    /* Animation Easing */
    --ease-out-expo: cubic-bezier(0.075, 0.82, 0.165, 1);
    --ease-in-out-smooth: cubic-bezier(0.4, 0.0, 0.2, 1);
    --controls-safe-area: clamp(84px, 12vh, 140px);
    --slide-outer-padding: clamp(20px, 4vh, 40px);
    --slide-padding: clamp(28px, 4.5vh, 64px);
    --slide-radius: clamp(28px, 4.5vh, 48px);
    --slide-max-width: min(1200px, 94vw);
}

body {
    margin: 0;
    padding: 0;
    font-family: var(--font-family);
    background-color: var(--color-surface-container);
    color: var(--color-on-surface);
    overflow: hidden;
    height: 100vh;
    width: 100vw;
}

/* --- Slides --- */
.slides-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

.slide {
    position: absolute;
    top: 0;
    bottom: var(--controls-safe-area);
    left: 0;
    width: 100%;
    height: auto;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transform: scale(1.05);
    transition: 
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo),
        visibility 0.6s;
    padding: var(--slide-outer-padding);
    box-sizing: border-box;
    z-index: 1;
}

.slide.active {
    opacity: 1;
    visibility: visible;
    transform: scale(1);
    z-index: 10;
}

.slide-content {
    background: var(--color-surface);
    width: var(--slide-max-width);
    height: 90%;
    max-height: 900px;
    border-radius: var(--slide-radius);
    box-shadow: 0 4px 24px rgba(0,0,0,0.08);
    padding: var(--slide-padding);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
}

.slide-content.center { align-items: center; justify-content: center; text-align: center; }
.slide-content.split-layout { flex-direction: row; gap: 48px; align-items: center; }
.text-col { flex: 1; }
/* Visual Col: Ensure overflow hidden to clip animations */
.visual-col { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; background: #fafbfc; border-radius: 32px; position: relative; overflow: hidden; }
.code-col { flex: 1; display: flex; align-items: center; justify-content: center; }

/* --- Architecture Overview --- */
.dual-card-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 32px; margin-top: 32px; }
.arch-card {
    position: relative;
    padding: 32px;
    border-radius: 32px;
    border: 1px solid #e6e8eb;
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateX(var(--offset)) scale(0.98);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.9s var(--ease-out-expo),
        box-shadow 0.9s var(--ease-out-expo);
    transition-delay: var(--delay);
}
.arch-card.arch-simclr { background: linear-gradient(135deg, #ffffff 0%, #f5f8ff 100%); }
.arch-card.arch-vae { background: linear-gradient(135deg, #ffffff 0%, #fff7f4 100%); }
.slide.active .arch-card { opacity: 1; transform: translateX(0) scale(1); box-shadow: 0 16px 40px rgba(0, 0, 0, 0.08); }
.arch-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
.arch-chip {
    padding: 6px 14px;
    border-radius: 999px;
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 0.3px;
}
.arch-chip.simclr { background: #e8f0fe; color: #1a73e8; }
.arch-chip.vae { background: #fce8e6; color: #d93025; }
.arch-tag { font-size: 12px; color: #5f6368; text-transform: uppercase; letter-spacing: 0.6px; }
.arch-desc { margin: 0 0 20px 0; color: var(--color-on-surface-variant); }
.arch-rows { display: grid; gap: 10px; margin-bottom: 20px; }
.arch-row { display: flex; justify-content: space-between; font-size: 15px; color: var(--color-on-surface); }
.arch-label { color: #5f6368; }
.arch-value { color: #1f1f1f; font-weight: 500; }
.arch-flow { display: flex; flex-wrap: wrap; align-items: center; gap: 8px; }
.flow-pill {
    padding: 6px 10px;
    border-radius: 999px;
    background: #f0f4f8;
    color: #1f1f1f;
    font-size: 12px;
    font-weight: 500;
}
.flow-arrow { color: #9aa0a6; font-size: 12px; }

/* --- Code Analysis --- */
.code-card {
    width: 100%;
    max-width: 520px;
    background: #f8f9fa;
    border-radius: 24px;
    border: 1px solid #e0e3e1;
    padding: 20px 22px;
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(12px) scale(0.98);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.9s var(--ease-out-expo),
        box-shadow 0.9s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .code-card {
    opacity: 1;
    transform: translateY(0) scale(1);
    animation: card-breathe 3.2s var(--ease-in-out-smooth) 0.6s infinite;
}
.code-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.code-file { font-size: 12px; font-weight: 600; color: #1f1f1f; text-transform: uppercase; letter-spacing: 0.6px; }
.code-meta { font-size: 12px; color: #5f6368; }
.code-body { font-family: var(--font-mono); font-size: 15px; line-height: 1.7; color: #1f1f1f; }
.code-line {
    opacity: 0;
    transform: translateY(8px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay);
}
.slide.active .code-line { opacity: 1; transform: translateY(0); }
.code-indent { display: inline-block; width: 16px; }
.code-accent { color: var(--color-primary); font-weight: 600; }
.code-dim { color: #8a9096; }
.code-highlight {
    position: relative;
    color: var(--color-primary);
    font-weight: 600;
    display: inline-block;
}
.code-highlight::before {
    content: "";
    position: absolute;
    left: -6px;
    right: -6px;
    top: -2px;
    bottom: -2px;
    background: rgba(66, 133, 244, 0.16);
    border-radius: 8px;
    transform: scaleX(0);
    transform-origin: left;
    opacity: 0;
}
.slide.active .code-highlight::before {
    animation: highlight-sweep 1.6s var(--ease-out-expo) 0.5s forwards;
}
.slide.active .code-highlight {
    animation: highlight-pop 1.6s var(--ease-out-expo) 0.5s forwards;
}
.code-underline { position: relative; color: #1a73e8; font-weight: 600; }
.code-underline::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -3px;
    height: 2px;
    width: 0;
    background: #1a73e8;
    border-radius: 999px;
}
.slide.active .code-underline::after {
    animation: underline-draw 1.2s var(--ease-out-expo) 0.6s forwards;
}
.code-focus {
    color: #d93025;
    font-weight: 600;
    display: inline-block;
}
.slide.active .code-focus {
    animation: focus-breathe 2.6s var(--ease-in-out-smooth) 0.6s infinite;
}
.code-pop {
    color: #1a73e8;
    font-weight: 600;
    display: inline-block;
}
.slide.active .code-pop {
    animation: highlight-pop 1.6s var(--ease-out-expo) 0.6s forwards;
}
.code-card.flicker {
    border-color: #d2e3fc;
}
.slide.active .code-card.flicker {
    animation: card-flicker 1.2s var(--ease-out-expo) 0.2s forwards,
        card-breathe 3.2s var(--ease-in-out-smooth) 1.4s infinite;
}
.code-block-highlight {
    position: relative;
    display: inline-block;
    font-weight: 600;
    color: #1f1f1f;
}
.code-block-highlight::before {
    content: "";
    position: absolute;
    left: -6px;
    right: -6px;
    top: -3px;
    bottom: -3px;
    background: rgba(66, 133, 244, 0.18);
    border-radius: 8px;
    transform: scaleX(0);
    transform-origin: left;
    opacity: 0;
}
.slide.active .code-block-highlight::before {
    animation: highlight-sweep 1.4s var(--ease-out-expo) 0.6s forwards;
}
.slide.active .code-block-highlight {
    animation: highlight-pop 1.6s var(--ease-out-expo) 0.6s forwards;
}
.code-note {
    margin-top: 16px;
    font-size: 13px;
    color: #5f6368;
    opacity: 0;
    transform: translateY(6px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .code-note {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 0.8s;
}
.code-click {
    position: relative;
    display: inline-block;
    color: #1a73e8;
    font-weight: 600;
}
.code-click::before {
    content: "";
    position: absolute;
    left: -6px;
    right: -6px;
    top: -3px;
    bottom: -3px;
    border-radius: 10px;
    background: rgba(26, 115, 232, 0.16);
    opacity: 0;
}
.slide.active .code-click::before {
    animation: click-pulse 1.4s var(--ease-out-expo) 0.6s forwards;
}

/* --- Optimization Chips --- */
.augmentation-chips { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
.aug-chip {
    padding: 6px 14px;
    border-radius: 999px;
    background: #f0f4f8;
    color: #1f1f1f;
    font-size: 12px;
    font-weight: 600;
}

/* --- NT-Xent Matrix --- */
.matrix-card {
    margin-top: 20px;
    background: #f8f9fa;
    border-radius: 24px;
    border: 1px solid #e0e3e1;
    padding: 20px;
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .matrix-card { opacity: 1; transform: translateY(0); }
.matrix-header { font-size: 12px; text-transform: uppercase; letter-spacing: 0.6px; color: #5f6368; margin-bottom: 16px; }
.matrix-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    padding: 10px;
    background: #ffffff;
    border-radius: 16px;
    border: 1px solid #e6e8eb;
}
.matrix-cell {
    width: 20px;
    height: 20px;
    border-radius: 6px;
    background: #e8eaed;
    opacity: 0;
    transform: scale(0.6);
}
.matrix-cell.diag { background: #fce8e6; }
.slide.active .matrix-cell {
    animation: matrix-pop 0.6s var(--ease-out-expo) 0.3s forwards;
}
.slide.active .matrix-cell.diag {
    animation: matrix-pop 0.6s var(--ease-out-expo) 0.3s forwards,
        diag-mask 1.4s var(--ease-out-expo) 0.8s forwards;
}
.matrix-legend { display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap; }
.legend-chip {
    padding: 4px 10px;
    border-radius: 999px;
    background: #f0f4f8;
    color: #5f6368;
    font-size: 11px;
}
.legend-chip.diag { background: #fce8e6; color: #d93025; }

/* --- Section 04 Results --- */
.table-card {
    background: #ffffff;
    border-radius: 24px;
    border: 1px solid #e0e3e1;
    padding: 20px;
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .table-card { opacity: 1; transform: translateY(0); }
.table-title { font-size: 12px; text-transform: uppercase; letter-spacing: 0.6px; color: #5f6368; margin-bottom: 12px; }
.comparison-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.comparison-table th { text-align: left; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: #5f6368; padding: 8px 6px; }
.comparison-table td { padding: 8px 6px; border-top: 1px solid #eef0f2; color: #1f1f1f; }
.comparison-table tr.row-highlight td { background: #fce8e6; font-weight: 600; }
.table-note { margin-top: 10px; font-size: 12px; color: #5f6368; }

.media-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 24px; margin-top: 24px; }
.media-card {
    background: #ffffff;
    border-radius: 24px;
    border: 1px solid #e0e3e1;
    padding: 16px;
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .media-card { opacity: 1; transform: translateY(0); }
.media-card.large { padding: 18px; }
.media-img {
    width: 100%;
    height: 260px;
    object-fit: contain;
    background: #f7f8fa;
    border-radius: 16px;
}
.media-card.large .media-img { height: 320px; }
.media-caption { margin-top: 12px; font-size: 13px; color: #5f6368; }

.loss-chart-card {
    background: #ffffff;
    border-radius: 28px;
    border: 1px solid #e0e3e1;
    padding: 20px 24px 16px;
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
}
.loss-chart { width: 100%; height: 340px; }
.loss-axis { stroke: #e0e3e1; stroke-width: 1.2; }
.loss-grid { stroke: #f1f3f4; stroke-width: 1; stroke-dasharray: 4 4; }
.loss-axis-text { font-size: 11px; fill: #8a9096; }
.loss-axis-label { font-size: 12px; fill: #5f6368; }
.loss-line {
    fill: none;
    stroke-width: 3;
    stroke-linecap: round;
    stroke-dasharray: 1200;
    stroke-dashoffset: 1200;
    transition: stroke-dashoffset 2.4s var(--ease-out-expo);
}
.slide.active .loss-line { stroke-dashoffset: 0; }
.loss-line.line-baseline { stroke: #5f6368; transition-delay: 0.1s; }
.loss-line.line-data { stroke: #1a73e8; transition-delay: 0.2s; }
.loss-line.line-temp01 { stroke: #ea4335; transition-delay: 0.3s; }
.loss-line.line-temp007 { stroke: #9b72cb; transition-delay: 0.4s; }
.loss-point {
    opacity: 0;
    transform: scale(0);
    transform-origin: center;
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .loss-point { opacity: 1; transform: scale(1); transition-delay: 2.2s; }
.loss-point.line-baseline { fill: #5f6368; }
.loss-point.line-data { fill: #1a73e8; }
.loss-point.line-temp01 { fill: #ea4335; }
.loss-point.line-temp007 { fill: #9b72cb; }
.chart-legend { display: flex; flex-wrap: wrap; gap: 12px 18px; margin-top: 14px; font-size: 12px; color: #5f6368; }
.legend-item { display: flex; align-items: center; gap: 8px; }
.legend-dot { width: 10px; height: 10px; border-radius: 999px; display: inline-block; }
.legend-dot.line-baseline { background: #5f6368; }
.legend-dot.line-data { background: #1a73e8; }
.legend-dot.line-temp01 { background: #ea4335; }
.legend-dot.line-temp007 { background: #9b72cb; }

.metric-card {
    margin-top: 24px;
    background: #f8f9fa;
    border-radius: 20px;
    border: 1px solid #e0e3e1;
    padding: 20px;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(10px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .metric-card { opacity: 1; transform: translateY(0); }
.metric-label { font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; color: #5f6368; margin-bottom: 8px; }
.metric-value { font-size: 36px; font-weight: 600; color: #1a73e8; }
.metric-note { font-size: 13px; color: #5f6368; margin-top: 6px; }

/* --- Lab4-1 Comparisons --- */
.compare-grid { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 16px; margin-top: 24px; }
.compare-grid.two-col { grid-template-columns: repeat(2, minmax(0, 1fr)); }
.compare-card {
    background: #ffffff;
    border-radius: 18px;
    border: 1px solid #e0e3e1;
    padding: 12px;
    box-shadow: 0 10px 22px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(10px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .compare-card { opacity: 1; transform: translateY(0); }
.compare-tag {
    font-size: 11px;
    color: #5f6368;
    text-transform: uppercase;
    letter-spacing: 0.4px;
    margin-bottom: 10px;
}
.compare-img {
    width: 100%;
    height: clamp(150px, 22vh, 220px);
    object-fit: contain;
    background: #f7f8fa;
    border-radius: 12px;
}
.compare-img.large { height: clamp(180px, 28vh, 280px); }

/* --- Lab4-2 Overview --- */
.overview-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 16px; margin-top: 28px; }
.overview-card {
    background: #f8f9fa;
    border-radius: 20px;
    border: 1px solid #e0e3e1;
    padding: 18px;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.05);
    opacity: 0;
    transform: translateY(10px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .overview-card { opacity: 1; transform: translateY(0); }
.overview-title { font-size: 13px; font-weight: 600; color: #1f1f1f; margin-bottom: 8px; }
.overview-card p { margin: 0; font-size: 14px; color: #5f6368; }

.image-frame {
    background: #ffffff;
    border-radius: 28px;
    border: 1px solid #e0e3e1;
    padding: 18px;
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.06);
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .image-frame { opacity: 1; transform: translateY(0); }
.image-frame .media-img { height: 320px; }
}
.image-reveal {
    position: relative;
    border-radius: 18px;
    overflow: hidden;
    background: #f7f8fa;
}
.image-reveal::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, #f7f8fa 0%, #eef1f4 100%);
    transform: translateX(0);
}
.slide.active .image-reveal::after {
    animation: reveal-sweep 1.8s var(--ease-out-expo) 0.4s forwards;
}

/* --- Gradient Formula Card --- */
/* --- Reparameterization Layout --- */
.analysis-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 32px; margin-top: 32px; align-items: center; }
.formula-card {
    background: #f8f9fa;
    border-radius: 24px;
    border: 1px solid #e0e3e1;
    padding: 24px;
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
    transition-delay: var(--delay, 0s);
}
.slide.active .formula-card { opacity: 1; transform: translateY(0); }
.formula-title { font-size: 12px; text-transform: uppercase; letter-spacing: 0.6px; color: #5f6368; margin-bottom: 12px; }
.formula-body { font-size: 26px; color: #1f1f1f; margin-bottom: 12px; }
.formula-note { margin: 0; color: #5f6368; }
.formula-card.gradient {
    background: linear-gradient(135deg, #f5f7ff 0%, #ffffff 55%, #fff5f5 100%);
    border: 1px solid #e3e6ef;
}

@keyframes card-breathe {
    0% { transform: translateY(0) scale(1); box-shadow: 0 10px 28px rgba(0, 0, 0, 0.06); }
    50% { transform: translateY(-2px) scale(1.01); box-shadow: 0 16px 34px rgba(0, 0, 0, 0.1); }
    100% { transform: translateY(0) scale(1); box-shadow: 0 10px 28px rgba(0, 0, 0, 0.06); }
}
@keyframes highlight-sweep {
    0% { transform: scaleX(0); opacity: 0; }
    30% { opacity: 1; }
    100% { transform: scaleX(1); opacity: 1; }
}
@keyframes highlight-pop {
    0% { transform: scale(1); }
    45% { transform: scale(1.06); }
    100% { transform: scale(1); }
}
@keyframes card-flicker {
    0% { opacity: 0; filter: brightness(1.2); }
    35% { opacity: 0.7; filter: brightness(1.05); }
    55% { opacity: 0.4; filter: brightness(0.95); }
    100% { opacity: 1; filter: brightness(1); }
}
@keyframes click-pulse {
    0% { opacity: 0; transform: scale(0.95); }
    35% { opacity: 0.9; transform: scale(1.02); }
    100% { opacity: 0; transform: scale(1); }
}
@keyframes matrix-pop {
    0% { opacity: 0; transform: scale(0.6); }
    100% { opacity: 1; transform: scale(1); }
}
@keyframes diag-mask {
    0% { background: #fce8e6; box-shadow: 0 0 0 rgba(217, 48, 37, 0); }
    60% { background: #fce8e6; box-shadow: 0 0 12px rgba(217, 48, 37, 0.25); }
    100% { background: #fce8e6; box-shadow: 0 0 0 rgba(217, 48, 37, 0); }
}
@keyframes reveal-sweep {
    0% { transform: translateX(0); }
    100% { transform: translateX(100%); }
}
@keyframes underline-draw {
    0% { width: 0; }
    100% { width: 100%; }
}
@keyframes focus-breathe {
    0% { text-shadow: 0 0 0 rgba(217, 48, 37, 0.0); }
    50% { text-shadow: 0 0 10px rgba(217, 48, 37, 0.35); }
    100% { text-shadow: 0 0 0 rgba(217, 48, 37, 0.0); }
}
@keyframes text-rise {
    0% { opacity: 0; transform: translateY(22px); filter: blur(8px); }
    100% { opacity: 1; transform: translateY(0); filter: blur(0); }
}
@keyframes reveal-wipe {
    0% { transform: translateY(0); }
    100% { transform: translateY(120%); }
}
@keyframes fade-rise {
    0% { opacity: 0; transform: translateY(18px); filter: blur(6px); }
    100% { opacity: 1; transform: translateY(0); filter: blur(0); }
}
@keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@media (max-width: 1200px) {
    .compare-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

@media (max-width: 960px) {
    .slide-content.split-layout { flex-direction: column; }
    .dual-card-grid { grid-template-columns: 1fr; }
    .analysis-grid { grid-template-columns: 1fr; }
    .code-card { max-width: 100%; }
    .media-grid { grid-template-columns: 1fr; }
    .loss-chart { height: 280px; }
    .overview-grid { grid-template-columns: 1fr; }
    .divider-title { font-size: 42px; }
}

@media (max-width: 720px) {
    .compare-grid { grid-template-columns: 1fr; }
    .compare-grid.two-col { grid-template-columns: 1fr; }
}

@media (max-height: 820px) {
    .slide-content { padding: clamp(22px, 3.8vh, 48px); overflow-y: auto; }
    .slide-content.section-break { overflow: hidden; }
    h1 { font-size: 48px; }
    h2 { font-size: 30px; }
    p, li { font-size: 16px; }
    .slide-subtitle { font-size: 16px; }
    .title-info-grid { gap: 16px; margin-top: 32px; }
    .dual-card-grid { gap: 20px; }
    .arch-card { padding: 24px; }
    .arch-row { font-size: 14px; }
    .flow-pill { font-size: 11px; padding: 5px 8px; }
    .code-body { font-size: 14px; }
    .media-img { height: 220px; }
    .image-frame .media-img { height: 260px; }
    .loss-chart { height: 260px; }
    .compare-img { height: clamp(130px, 20vh, 200px); }
    .compare-img.large { height: clamp(160px, 24vh, 240px); }
}

@media (max-height: 720px) {
    .slide-content { padding: clamp(18px, 3.2vh, 40px); }
    h1 { font-size: 42px; }
    h2 { font-size: 26px; }
    .media-img { height: 200px; }
    .loss-chart { height: 240px; }
    .divider-title { font-size: 38px; }
    .compare-img { height: clamp(120px, 18vh, 180px); }
    .compare-img.large { height: clamp(140px, 22vh, 210px); }
}

/* --- Typography --- */
h1 {
    font-size: 56px;
    font-weight: 500;
    letter-spacing: -1px;
    margin-bottom: 24px;
    background: var(--gemini-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1.2;
}
h2 { font-size: 36px; font-weight: 500; margin: 0 0 24px 0; color: var(--color-on-surface); }
h3 { margin: 0 0 8px 0; font-size: 20px; font-weight: 500; }
p, li { font-size: 18px; line-height: 1.6; color: var(--color-on-surface-variant); margin-bottom: 12px; }
.slide-subtitle { font-size: 18px; color: var(--color-on-surface-variant); margin: -8px 0 24px 0; }

/* --- Title Slide Reveal --- */
.animate-reveal,
.animate-fade-up {
    opacity: 0;
    transform: translateY(18px);
    filter: blur(6px);
}
.animate-reveal {
    position: relative;
    display: inline-block;
}
.animate-reveal::after {
    content: "";
    position: absolute;
    inset: -6px;
    background: var(--color-surface);
    border-radius: 12px;
    transform: translateY(0);
}
.slide.active .animate-reveal {
    animation: text-rise 1s var(--ease-out-expo) forwards;
    animation-delay: var(--delay, 0s);
}
.slide.active .animate-reveal::after {
    animation: reveal-wipe 1s var(--ease-out-expo) forwards;
    animation-delay: var(--delay, 0s);
}
.slide.active .animate-fade-up {
    animation: fade-rise 0.9s var(--ease-out-expo) forwards;
    animation-delay: var(--delay, 0s);
}
.slide[data-type="title"] .badge.animate-reveal { --delay: 0.1s; }
.slide[data-type="title"] h1.animate-reveal { --delay: 0.2s; }
.slide[data-type="title"] .hero-desc.animate-fade-up { --delay: 0.35s; }
.slide[data-type="title"] .title-info-grid.animate-fade-up { --delay: 0.5s; }
.slide[data-type="title"] .title-info-grid { margin-top: 40px; margin-bottom: 24px; }

/* --- Section Divider --- */
.slide-content.section-break {
    background:
        radial-gradient(circle at 18% 20%, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0) 60%),
        radial-gradient(circle at 82% 75%, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0) 55%),
        linear-gradient(135deg, #3b73f0 0%, #8a7cf0 40%, #e58aa5 70%, #f4bf84 100%);
    background-size: 200% 200%;
    color: #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    animation: gradient-shift 9s var(--ease-in-out-smooth) infinite;
}
.section-break h1,
.section-break p { color: #ffffff; }
.section-break h1 {
    background: none;
    -webkit-text-fill-color: #ffffff;
    -webkit-background-clip: border-box;
}
.break-inner { max-width: 720px; }
.break-label {
    display: inline-block;
    padding: 6px 16px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.18);
    color: #ffffff;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.6px;
    text-transform: uppercase;
    margin-bottom: 20px;
    opacity: 0;
    transform: translateY(18px);
}
.divider-title {
    margin: 0 0 12px 0;
    font-size: 54px;
    font-weight: 600;
    opacity: 0;
    transform: translateY(24px);
    filter: blur(6px);
}
.divider-subtitle {
    font-size: 18px;
    opacity: 0;
    transform: translateY(18px);
    filter: blur(6px);
}
.slide.active .break-label {
    animation: fade-rise 0.9s var(--ease-out-expo) forwards;
    animation-delay: 0.1s;
}
.slide.active .divider-title {
    animation: text-rise 1.1s var(--ease-out-expo) forwards;
    animation-delay: 0.2s;
}
.slide.active .divider-subtitle {
    animation: fade-rise 0.9s var(--ease-out-expo) forwards;
    animation-delay: 0.4s;
}

/* --- Slide 3: SimCLR Concept Animation (Fixed Layout) --- */
.anim-concept-simclr {
    position: relative;
    width: 300px; /* Constrained width to prevent overlap */
    height: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
}
.anim-concept-simclr .circle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 12px;
    font-weight: 500;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    
    /* Centered initially */
    left: 50%;
    top: 50%;
    margin-left: -25px; /* Half width to truly center */
    margin-top: -25px;
    
    transform: scale(0);
    opacity: 0;
    transition: all 1s var(--ease-out-expo);
}

.anim-concept-simclr .origin { background: #5f6368; z-index: 10; }
.anim-concept-simclr .view1 { background: #4285f4; z-index: 5; }
.anim-concept-simclr .view2 { background: #ea4335; z-index: 5; }
.anim-concept-simclr .neg { background: #e0e0e0; color: #999; z-index: 2; width: 30px; height: 30px; margin-left: -15px; margin-top: -15px; }

/* Trigger: Cell Division & Repulsion */
.slide.active .anim-concept-simclr .origin {
    transform: scale(1);
    opacity: 1;
    transition-delay: 0.2s;
}
/* Views split left/right */
.slide.active .anim-concept-simclr .view1 {
    opacity: 1;
    transform: translate(-60px, 0) scale(1.1);
    transition-delay: 0.8s;
}
.slide.active .anim-concept-simclr .view2 {
    opacity: 1;
    transform: translate(60px, 0) scale(1.1);
    transition-delay: 0.8s;
}
/* Negatives scattered to corners */
.slide.active .anim-concept-simclr .n1 { opacity: 1; transform: translate(-100px, -100px); transition-delay: 1.2s; }
.slide.active .anim-concept-simclr .n2 { opacity: 1; transform: translate(100px, -100px); transition-delay: 1.2s; }
.slide.active .anim-concept-simclr .n3 { opacity: 1; transform: translate(-100px, 100px); transition-delay: 1.2s; }
.slide.active .anim-concept-simclr .n4 { opacity: 1; transform: translate(100px, 100px); transition-delay: 1.2s; }


/* --- Slide 5: Augmentation Images --- */
.aug-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    width: 100%;
    padding: 24px;
}
.aug-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}
.aug-img {
    width: 120px;
    height: 120px;
    background-color: #ddd;
    border-radius: 16px;
    background-image: url('https://picsum.photos/id/1025/300/300'); /* Pug dog */
    background-size: cover;
    background-position: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: transform 0.3s;
}
.aug-img:hover { transform: scale(1.05); }

/* Simulate Augmentations */
.aug-img.crop { 
    background-size: 180%; /* Zoom in */
    background-position: 30% 40%; /* Offset */
}
.aug-img.color { 
    filter: hue-rotate(90deg) contrast(1.5) saturate(1.5); 
}
.aug-img.blur { 
    filter: blur(3px); 
}


/* --- Loss Curve Animation --- */
.anim-path {
    stroke-dasharray: 3000;
    stroke-dashoffset: 3000;
    transition: stroke-dashoffset 2s ease-out;
}
.slide.active .anim-path {
    stroke-dashoffset: 0;
    transition-delay: 0.5s;
}

/* --- t-SNE Scatter --- */
.scatter-plot {
    position: relative;
    width: 300px;
    height: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
}
.dot-group {
    position: absolute;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    opacity: 0;
    transform: scale(0);
}
.slide.active .dot-group {
    animation: scatter-out 1.5s var(--ease-out-expo) forwards;
}
@keyframes scatter-out {
    0% { transform: translate(0, 0) scale(0); opacity: 0; }
    100% { transform: translate(var(--tx), var(--ty)) scale(1); opacity: 0.8; }
}
.d1 { animation-delay: 0.2s; }
.d2 { animation-delay: 0.3s; }
.d3 { animation-delay: 0.4s; }
.d4 { animation-delay: 0.5s; }


/* --- VAE Diagram --- */
.vae-diagram-detailed {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    margin-top: 24px;
}
.vae-block {
    padding: 24px;
    background: #f0f4f8;
    border-radius: 16px;
    text-align: center;
    width: 160px;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.6s var(--ease-out-expo);
}
.vae-arrow { opacity: 0; transition: opacity 0.5s ease; font-size: 24px; color: #999; }

.slide.active .vae-block:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.2s; }
.slide.active .vae-arrow:nth-child(2) { opacity: 1; transition-delay: 0.4s; }
.slide.active .vae-block:nth-child(3) { opacity: 1; transform: translateY(0); transition-delay: 0.6s; }
.slide.active .vae-arrow:nth-child(4) { opacity: 1; transition-delay: 0.8s; }
.slide.active .vae-block:nth-child(5) { opacity: 1; transform: translateY(0); transition-delay: 1.0s; }


/* --- Misc --- */
.title-info-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-top: 48px; width: 100%; max-width: 900px; }
.info-item { display: flex; flex-direction: column; align-items: center; padding: 16px; background: #f0f4f8; border-radius: 16px; }
.info-item .label { font-size: 12px; text-transform: uppercase; color: #444746; margin-bottom: 4px; }
.info-item .value { font-size: 16px; font-weight: 500; color: #1f1f1f; }

.controls { position: fixed; bottom: clamp(8px, 2vh, 24px); left: 50%; transform: translateX(-50%); background: rgba(255, 255, 255, 0.9); padding: 8px 16px; border-radius: 999px; display: flex; align-items: center; gap: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 100; border: 1px solid #e0e3e1; }
.nav-btn { background: none; border: none; cursor: pointer; padding: 8px; border-radius: 50%; color: #444746; }
.progress-container { width: 200px; height: 4px; background: #e0e3e1; border-radius: 2px; overflow: hidden; }
.progress-bar { height: 100%; background: var(--color-primary); width: 0%; transition: width 0.3s ease; }

.stagger-list li { margin-bottom: 24px; opacity: 0; transform: translateX(-20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out; display: flex; }
.slide.active .stagger-list li { opacity: 1; transform: translateX(0); }
.slide.active .stagger-list li:nth-child(1) { transition-delay: 0.1s; }
.slide.active .stagger-list li:nth-child(2) { transition-delay: 0.2s; }
.slide.active .stagger-list li:nth-child(3) { transition-delay: 0.3s; }
.slide.active .stagger-list li:nth-child(4) { transition-delay: 0.4s; }
.bullet-num { font-weight: bold; color: #4285f4; margin-right: 16px; font-size: 24px; }

.checklist li { padding-left: 32px; position: relative; margin-bottom: 16px; }
.checklist li::before { content: "âœ“"; position: absolute; left: 0; top: 0; color: #34a853; font-weight: bold; font-size: 20px; }

.flow-diagram-detailed { display: flex; align-items: center; justify-content: space-between; margin-top: 24px; width: 100%; }
.f-stage { display: flex; flex-direction: column; align-items: center; gap: 8px; }
.f-box { width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; border: 2px solid #e0e3e1; }
.f-group { display: flex; flex-direction: column; gap: 8px; }
.data { background: #f0f4f8; }
.aug { background: #e8f0fe; border-color: #4285f4; }
.rep { background: #fce8e6; border-color: #ea4335; }
.proj { background: #fff8e1; border-color: #fbbc04; }
.loss { width: 60px; height: 60px; border-radius: 50%; background: #333; color: #fff; border: none; }
.f-label { font-size: 12px; color: #666; text-align: center; }
.f-arrow { color: #999; font-size: 14px; }

.code-snippet-box { background: #f8f9fa; padding: 16px; border-radius: 12px; font-family: monospace; font-size: 14px; color: #444746; border-left: 4px solid #1a73e8; }
.hl { color: #d93025; font-weight: bold; }
.kw { color: #1a73e8; font-weight: bold; }

.equation-display { font-size: 20px; padding: 24px; background: #f8f9fa; border-radius: 16px; margin-bottom: 32px; width: 80%; }
.chart-container { width: 100%; height: 300px; position: relative; margin-top: 24px; }
.line-chart { width: 100%; height: 100%; }
.chart-axis-text { font-size: 12px; fill: #999; }

.feature-list { display: flex; flex-direction: column; gap: 20px; }
.feature-item { padding: 20px; background: #f8f9fa; border-radius: 16px; border-left: 4px solid #4285f4; }

.grid-compare { display: flex; justify-content: center; gap: 32px; }
.compare-pair { display: flex; flex-direction: column; align-items: center; gap: 8px; }
.img-orig { width: 120px; height: 120px; background: #ddd; border-radius: 12px; background-image: url('https://picsum.photos/id/237/200/200'); background-size: cover; }
.img-recon { width: 120px; height: 120px; background: #ddd; border-radius: 12px; background-image: url('https://picsum.photos/id/237/200/200'); background-size: cover; filter: blur(3px); opacity: 0.9; }

.badge { background: #e8f0fe; color: #1a73e8; padding: 6px 16px; border-radius: 99px; font-size: 14px; font-weight: 600; margin-bottom: 24px; display: inline-block; }
.checklist-card { display: flex; flex-direction: column; gap: 16px; width: 100%; max-width: 800px; margin-top: 40px; }
.check-item {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    padding: 16px;
    background: #f8f9fa;
    border-radius: 12px;
    text-align: left;
    opacity: 0;
    transform: translateY(12px);
    transition:
        opacity 0.6s var(--ease-in-out-smooth),
        transform 0.8s var(--ease-out-expo);
}
.slide.active .check-item { opacity: 1; transform: translateY(0); }
.slide.active .checklist-card .check-item:nth-child(1) { transition-delay: 0.1s; }
.slide.active .checklist-card .check-item:nth-child(2) { transition-delay: 0.2s; }
.slide.active .checklist-card .check-item:nth-child(3) { transition-delay: 0.3s; }
.slide.active .checklist-card .check-item:nth-child(4) { transition-delay: 0.4s; }
.check-icon { width: 24px; height: 24px; background: #34a853; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
.check-item.future .check-icon { background: #4285f4; }
.end-anim { margin-top: 48px; font-size: 24px; color: #444746; animation: fadeIn 2s ease-in; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
